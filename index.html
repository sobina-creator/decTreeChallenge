<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Decision Tree Challenge</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Decision Tree Challenge</h1>
<p class="subtitle lead">Feature Importance and Categorical Variable Encoding</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="decision-tree-challenge---feature-importance-and-variable-encoding" class="level1">
<h1>üå≥ Decision Tree Challenge - Feature Importance and Variable Encoding</h1>
<section id="challenge-overview" class="level2">
<h2 class="anchored" data-anchor-id="challenge-overview">Challenge Overview</h2>
<p><strong>Your Mission:</strong> Create a simple GitHub Pages site that demonstrates how decision trees measure feature importance and analyzes the critical differences between categorical and numerical variable encoding. You‚Äôll answer two key discussion questions by adding narrative to a pre-built analysis and posting those answers to your GitHub Pages site as a rendered HTML document.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>‚ö†Ô∏è AI Partnership Required
</div>
</div>
<div class="callout-body-container callout-body">
<p>This challenge pushes boundaries intentionally. You‚Äôll tackle problems that normally require weeks of study, but with Cursor AI as your partner (and your brain keeping it honest), you can accomplish more than you thought possible.</p>
<p><strong>The new reality:</strong> The four stages of competence are Ignorance ‚Üí Awareness ‚Üí Learning ‚Üí Mastery. AI lets us produce Mastery-level work while operating primarily in the Awareness stage. I focus on awareness training, you leverage AI for execution, and together we create outputs that used to require years of dedicated study.</p>
</div>
</div>
</section>
<section id="the-decision-tree-problem" class="level2">
<h2 class="anchored" data-anchor-id="the-decision-tree-problem">The Decision Tree Problem üéØ</h2>
<blockquote class="blockquote">
<p>‚ÄúThe most important thing in communication is hearing what isn‚Äôt said.‚Äù - Peter Drucker</p>
</blockquote>
<p><strong>The Core Problem:</strong> Decision trees are often praised for their interpretability and ability to handle both numerical and categorical variables. But what happens when we encode categorical variables as numbers? How does this affect our understanding of feature importance?</p>
<p><strong>What is Feature Importance?</strong> In decision trees, feature importance measures how much each variable contributes to reducing impurity (or improving prediction accuracy) across all splits in the tree. It‚Äôs a key metric for understanding which variables matter most for your predictions.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>üéØ The Key Insight: Encoding Matters for Interpretability
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>The problem:</strong> When we encode categorical variables as numerical values (like 1, 2, 3, 4‚Ä¶), decision trees treat them as if they have a meaningful numerical order. This can completely distort our analysis.</p>
<p><strong>The Real-World Context:</strong> In real estate, we know that neighborhood quality, house style, and other categorical factors are crucial for predicting home prices. But if we encode these as numbers, we might get misleading insights about which features actually matter most.</p>
<p><strong>The Devastating Reality:</strong> Even sophisticated machine learning models can give us completely wrong insights about feature importance if we don‚Äôt properly encode our variables. A categorical variable that should be among the most important might appear irrelevant, while a numerical variable might appear artificially important.</p>
</div>
</div>
<p>Let‚Äôs assume we want to predict house prices and understand which features matter most. The key question is: <strong>How does encoding categorical variables as numbers affect our understanding of feature importance?</strong></p>
</section>
<section id="the-ames-housing-dataset" class="level2">
<h2 class="anchored" data-anchor-id="the-ames-housing-dataset">The Ames Housing Dataset üè†</h2>
<p>We are analyzing the Ames Housing dataset which contains detailed information about residential properties sold in Ames, Iowa from 2006 to 2010. This dataset is perfect for our analysis because it contains a categorical variable (like zip code) and numerical variables (like square footage, year built, number of bedrooms).</p>
</section>
<section id="the-problem-zipcode-as-numerical-vs-categorical" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-zipcode-as-numerical-vs-categorical">The Problem: ZipCode as Numerical vs Categorical</h2>
<p><strong>Key Question:</strong> What happens when we treat zipCode as a numerical variable in a decision tree? How does this affect feature importance interpretation?</p>
<p><strong>The Issue:</strong> Zip codes (50010, 50011, 50012, 50013) are categorical variables representing discrete geographic areas, i.e.&nbsp;neighborhoods. When treated as numerical, the tree might split on ‚ÄúzipCode &gt; 50012.5‚Äù - which has no meaningful interpretation for house prices. Zip codes are non-ordinal categorical variables meaning they have no inherent order that aids house price prediction (i.e.&nbsp;zip code 99999 is not the priceiest zip code).</p>
</section>
<section id="data-loading-and-model-building" class="level2">
<h2 class="anchored" data-anchor-id="data-loading-and-model-building">Data Loading and Model Building</h2>
<section id="python" class="level3">
<h3 class="anchored" data-anchor-id="python">Python</h3>
<div id="load-and-model-python" class="cell" data-execution_count="1">
<div class="cell-output cell-output-stdout">
<pre><code>Model built with 8 terminal nodes</code></pre>
</div>
</div>
</section>
</section>
<section id="tree-visualization" class="level2">
<h2 class="anchored" data-anchor-id="tree-visualization">Tree Visualization</h2>
<section id="python-1" class="level3">
<h3 class="anchored" data-anchor-id="python-1">Python</h3>
<div id="cell-visualize-tree-python" class="cell" data-fig-height="6" data-fig-width="10" data-execution_count="2">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/visualize-tree-python-output-1.png" id="visualize-tree-python" width="942" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="feature-importance-analysis" class="level2">
<h2 class="anchored" data-anchor-id="feature-importance-analysis">Feature Importance Analysis</h2>
<section id="python-2" class="level3">
<h3 class="anchored" data-anchor-id="python-2">Python</h3>
<div id="cell-importance-plot-python" class="cell" data-fig-height="5" data-fig-width="8" data-execution_count="4">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/importance-plot-python-output-1.png" id="importance-plot-python" width="758" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="critical-analysis-the-encoding-problem" class="level2">
<h2 class="anchored" data-anchor-id="critical-analysis-the-encoding-problem">Critical Analysis: The Encoding Problem</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>‚ö†Ô∏è The Problem Revealed
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>What to note:</strong> Our decision tree treated <code>zipCode</code> as a numerical variable. This leads to zip code being unimportant. Not surprisingly, because there is no reason to believe allowing splits like ‚ÄúzipCode &lt; 50012.5‚Äù should be beneficial for house price prediction. This false coding of a variable creates several problems:</p>
<ol type="1">
<li><strong>Potentially Meaningless Splits:</strong> A zip code of 50013 is not ‚Äúgreater than‚Äù 50012 in any meaningful way for house prices</li>
<li><strong>False Importance:</strong> The algorithm assigns importance to zipCode based on numerical splits rather than categorical distinctions OR the importance of zip code is completely missed as numerical ordering has no inherent relationship to house prices.</li>
<li><strong>Misleading Interpretations:</strong> We might conclude zipCode is not important when our intuition tells us it should be important (listen to your intuition).</li>
</ol>
<p><strong>The Real Issue:</strong> Zip codes are categorical variables representing discrete geographic areas. The numerical values have no inherent order or magnitude relationship to house prices. These must be modelled as categorical variables.</p>
</div>
</div>
</section>
<section id="proper-categorical-encoding-the-solution" class="level2">
<h2 class="anchored" data-anchor-id="proper-categorical-encoding-the-solution">Proper Categorical Encoding: The Solution</h2>
<p>Now let‚Äôs repeat the analysis with zipCode properly encoded as categorical variables to see the difference.</p>
<p><strong>Python Approach:</strong> One-hot encode zipCode (create dummy variables for each zip code)</p>
<section id="categorical-encoding-analysis" class="level3">
<h3 class="anchored" data-anchor-id="categorical-encoding-analysis">Categorical Encoding Analysis</h3>
</section>
<section id="python-3" class="level3">
<h3 class="anchored" data-anchor-id="python-3">Python</h3>
</section>
<section id="tree-visualization-categorical-zipcode" class="level3">
<h3 class="anchored" data-anchor-id="tree-visualization-categorical-zipcode">Tree Visualization: Categorical zipCode</h3>
</section>
<section id="python-4" class="level3">
<h3 class="anchored" data-anchor-id="python-4">Python</h3>
<div id="cell-visualize-tree-cat-python" class="cell" data-fig-height="6" data-fig-width="10" data-execution_count="6">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/visualize-tree-cat-python-output-1.png" id="visualize-tree-cat-python" width="938" height="566" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="feature-importance-categorical-zipcode" class="level3">
<h3 class="anchored" data-anchor-id="feature-importance-categorical-zipcode">Feature Importance: Categorical zipCode</h3>
</section>
<section id="python-5" class="level3">
<h3 class="anchored" data-anchor-id="python-5">Python</h3>
<div id="cell-importance-plot-cat-python" class="cell" data-fig-height="5" data-fig-width="8" data-execution_count="7">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/importance-plot-cat-python-output-1.png" id="importance-plot-cat-python" width="757" height="470" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="challenge-requirements" class="level2">
<h2 class="anchored" data-anchor-id="challenge-requirements">Challenge Requirements üìã</h2>
<section id="minimum-requirements-for-any-points-on-challenge" class="level3">
<h3 class="anchored" data-anchor-id="minimum-requirements-for-any-points-on-challenge">Minimum Requirements for Any Points on Challenge</h3>
<ol type="1">
<li><p><strong>Create a GitHub Pages Site:</strong> Use the starter repository (see Repository Setup section below) to begin with a working template. The repository includes all the analysis code and visualizations above.</p></li>
<li><p><strong>Add Discussion Narrative:</strong> Add your answers to the two discussion questions below in the Discussion Questions section of the rendered HTML.</p></li>
<li><p><strong>GitHub Repository:</strong> Use your forked repository (from the starter repository) named ‚ÄúdecTreeChallenge‚Äù in your GitHub account.</p></li>
<li><p><strong>GitHub Pages Setup:</strong> The repository should be made the source of your github pages:</p>
<ul>
<li>Go to your repository settings (click the ‚ÄúSettings‚Äù tab in your GitHub repository)</li>
<li>Scroll down to the ‚ÄúPages‚Äù section in the left sidebar</li>
<li>Under ‚ÄúSource‚Äù, select ‚ÄúDeploy from a branch‚Äù</li>
<li>Choose ‚Äúmain‚Äù branch and ‚Äú/ (root)‚Äù folder</li>
<li>Click ‚ÄúSave‚Äù</li>
<li>Your site will be available at: <code>https://[your-username].github.io/decTreeChallenge/</code></li>
<li><strong>Note:</strong> It may take a few minutes for the site to become available after enabling Pages</li>
</ul></li>
</ol>
</section>
</section>
<section id="getting-started-repository-setup" class="level2">
<h2 class="anchored" data-anchor-id="getting-started-repository-setup">Getting Started: Repository Setup üöÄ</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>üìÅ Quick Start with Starter Repository
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Step 1:</strong> Fork the starter repository to your github account at <a href="https://github.com/flyaflya/decTreeChallenge.git">https://github.com/flyaflya/decTreeChallenge.git</a></p>
<p><strong>Step 2:</strong> Clone your fork locally using Cursor (or VS Code)</p>
<p><strong>Step 3:</strong> You‚Äôre ready to start! The repository includes pre-loaded data and a working template with all the analysis above.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>üí° Why Use the Starter Repository?
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Benefits:</strong></p>
<ul>
<li><strong>Pre-loaded data:</strong> All required data and analysis code is included</li>
<li><strong>Working template:</strong> Basic Quarto structure (<code>index.qmd</code>) is ready</li>
<li><strong>No setup errors:</strong> Avoid common data loading issues</li>
<li><strong>Focus on analysis:</strong> Spend time on the discussion questions, not data preparation</li>
</ul>
</div>
</div>
<section id="getting-started-tips" class="level3">
<h3 class="anchored" data-anchor-id="getting-started-tips">Getting Started Tips</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>üéØ Navy SEALs Motto
</div>
</div>
<div class="callout-body-container callout-body">
<blockquote class="blockquote">
<p>‚ÄúSlow is Smooth and Smooth is Fast‚Äù</p>
</blockquote>
<p><em>Take your time to understand the decision tree mechanics, plan your approach carefully, and execute with precision. Rushing through this challenge will only lead to errors and confusion.</em></p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>üíæ Important: Save Your Work Frequently!
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Before you start:</strong> Make sure to commit your work often using the Source Control panel in Cursor (Ctrl+Shift+G or Cmd+Shift+G). This prevents the AI from overwriting your progress and ensures you don‚Äôt lose your work.</p>
<p><strong>Commit after each major step:</strong></p>
<ul>
<li>After adding your discussion answers</li>
<li>After rendering to HTML</li>
<li>Before asking the AI for help with new code</li>
</ul>
<p><strong>How to commit:</strong></p>
<ol type="1">
<li>Open Source Control panel (Ctrl+Shift+G)</li>
<li>Stage your changes (+ button)</li>
<li>Write a descriptive commit message</li>
<li>Click the checkmark to commit</li>
</ol>
<p><em>Remember: Frequent commits are your safety net!</em></p>
</div>
</div>
</section>
</section>
<section id="discussion-questions-for-challenge" class="level2">
<h2 class="anchored" data-anchor-id="discussion-questions-for-challenge">Discussion Questions for Challenge</h2>
<p><strong>Your Task:</strong> Add thoughtful narrative answers to these two questions in the Discussion Questions section of your rendered HTML site.</p>
<ol type="1">
<li><strong>Numerical vs Categorical Encoding:</strong> There are two modelsin Python written above. For each language, the models differ by how zip code is modelled, either as a numerical variable or as a categorical variable. Given what you know about zip codes and real estate prices, how should zip code be modelled, numerically or categorically? Is zipcode and ordinal or non-ordinal variable? ### 1. Numerical vs Categorical Encoding: How Should Zip Code Be Modelled?</li>
</ol>
<p>Zip codes, by their nature, represent distinct, non-overlapping geographic areas‚Äîessentially unique ‚Äúlabels‚Äù for neighborhoods or regions. In the context of real estate, they do a great job at segmenting properties based on local market conditions or neighborhood effects, but this segmentation does <strong>not</strong> represent a true numerical or ordered relationship. The difference between zip codes 50010 and 50012 is not inherently meaningful in terms of value or physical distance‚Äîit‚Äôs just a difference in label.</p>
<section id="should-zip-code-be-coded-numerically-or-categorically" class="level4">
<h4 class="anchored" data-anchor-id="should-zip-code-be-coded-numerically-or-categorically">Should Zip Code Be Coded Numerically or Categorically?</h4>
<p><strong>Zip code should always be modelled as a <em>categorical variable</em>, not a numerical one.</strong></p>
<ul>
<li><strong>Why not numerical?</strong><br>
Treating zip codes as numbers (e.g., 50010, 50011, 50012) leads the model to impose an artificial sense of ‚Äúdistance‚Äù or order that does not actually exist between them. In our analysis, for example, the decision tree might split on ‚ÄúzipCode &gt; 50011.5,‚Äù which makes no real-world sense‚Äîthere is no continuum in zip codes; 50012 isn‚Äôt somehow ‚Äúmore‚Äù or ‚Äúhigher‚Äù than 50010 in a property value context.</li>
<li><strong>Why categorical?</strong><br>
When zip code is treated as a categorical variable, each distinct code is simply a unique group, and the model is allowed to split and assign importance based solely on actual group membership, not on any mathematical comparison or order.</li>
</ul>
</section>
<section id="is-zip-code-ordinal-or-non-ordinal" class="level4">
<h4 class="anchored" data-anchor-id="is-zip-code-ordinal-or-non-ordinal">Is Zip Code Ordinal or Non-Ordinal?</h4>
<p><strong>Zip code is a <em>non-ordinal</em> categorical variable.</strong><br>
There is no natural or meaningful order to zip codes when it comes to housing prices or most other analyses. Unlike an ordinal variable (such as a rating scale from ‚Äúpoor‚Äù to ‚Äúexcellent‚Äù), zip codes do not encode any progression or relative ranking‚Äîeach one just identifies a unique area.</p>
</section>
<section id="practical-implication" class="level4">
<h4 class="anchored" data-anchor-id="practical-implication">Practical Implication</h4>
<p>If you encode zip codes as numbers, you risk <strong>seriously misleading feature importance rankings</strong> and the splits in your decision tree can become nonsensical. For meaningful and interpretable results‚Äîespecially when explaining model decisions to non-technical audiences‚Äî<strong>always treat zip code as categorical.</strong></p>
<p><strong>Bottom line:</strong><br>
&gt; <em>Zip code is a non-ordinal categorical variable and should always be represented as categorical (not numerical) in decision tree models. Modelling it numerically can create false relationships and harm the interpretability and accuracy of your analysis.</em></p>
<ol start="2" type="1">
<li><strong>R vs Python Implementation Differences:</strong> When modelling zip code as a categorical variable, the output tree and feature importance would differ quite significantly had you used R as opposed to Python. Investigate why this is the case. What does R offer that Python does not? Which language would you say does a better job of modelling zip code as a categorical variable? Can you quote the documentation at <a href="https://scikit-learn.org/stable/modules/tree.html">https://scikit-learn.org/stable/modules/tree.html</a> suggesting a weakness in the Python implementation? If so, please provide a quote from the documentation. ### 2. R vs Python Implementation Differences: How Do The Languages Handle Categorical Variables in Trees?</li>
</ol>
<p>When it comes to decision tree models‚Äîespecially with categorical features like zip code‚Äîthe way R and Python (scikit-learn) handle those variables is fundamentally different, with important consequences for interpretation and feature importance.</p>
</section>
<section id="why-do-r-and-python-scikit-learn-give-different-results" class="level4">
<h4 class="anchored" data-anchor-id="why-do-r-and-python-scikit-learn-give-different-results">Why Do R and Python (scikit-learn) Give Different Results?</h4>
<ul>
<li><strong>R (<code>rpart</code> and friends):</strong>
<ul>
<li>In R, libraries like <code>rpart</code> and <code>party</code> natively support categorical variables. If you declare a variable as a factor, the decision tree can split nodes based on any grouping or level of that factor. For a zip code factor with four categories, R considers all possible ways to split those categories at each node.</li>
<li>This means the algorithm can efficiently find the optimal way to partition the zip code groups, recognizing that they have no natural order and should be treated as separate bins.</li>
</ul></li>
<li><strong>Python (<code>sklearn.tree.DecisionTreeRegressor</code>):</strong>
<ul>
<li>In scikit-learn, decision trees require all input features to be numeric. There is <strong>no native support for categorical variables.</strong></li>
<li>The common approach is to encode categorical variables using <strong>one-hot encoding</strong> or similar strategies. Each zip code is converted into a separate binary indicator column. This can lead to a dramatic explosion in the number of features if the categorical variable has many unique values.</li>
<li>Importantly, this approach loses the ability to perform multiway splits directly on the original categories, and the model process becomes both less efficient and less interpretable.</li>
</ul></li>
</ul>
</section>
<section id="what-does-r-offer-that-python-does-not" class="level4">
<h4 class="anchored" data-anchor-id="what-does-r-offer-that-python-does-not">What Does R Offer That Python Does Not?</h4>
<ul>
<li><strong>Native Handling of Categorical Variables:</strong> R‚Äôs <code>rpart</code> recognizes factors and explores all possible groupings, leading to cleaner, more interpretable splits‚Äîparticularly valuable for high-cardinality features.</li>
<li><strong>Efficient Multiway Splits:</strong> R can split a categorical variable into any grouping of its levels, not just binary splits or dummy columns.</li>
<li><strong>Cleaner Feature Importance:</strong> Because the splits correspond to real-world groupings (e.g., ‚ÄúzipCode in {50010,50012} vs {50011,50013}‚Äù), the feature importance is more natural and meaningful.</li>
</ul>
</section>
<section id="which-language-does-a-better-job" class="level4">
<h4 class="anchored" data-anchor-id="which-language-does-a-better-job">Which Language Does a Better Job?</h4>
<p>For categorical variables, <strong>R (using <code>rpart</code> or similar libraries) does a better job</strong>. Its native treatment of factors means you get more faithful, interpretable, and efficient modeling of categorical variables like zip code, versus Python‚Äôs scikit-learn, which is forced to use brute-force encoding tricks.</p>
</section>
<section id="official-documentation-a-weakness-in-pythons-handling" class="level4">
<h4 class="anchored" data-anchor-id="official-documentation-a-weakness-in-pythons-handling">Official Documentation: A Weakness in Python‚Äôs Handling</h4>
<p>From the <a href="https://scikit-learn.org/stable/modules/tree.html">official scikit-learn decision tree documentation</a>:</p>
<blockquote class="blockquote">
<p>‚Äú<strong>Note:</strong> There is no support for categorical variables in scikit-learn. All features are assumed to be numeric. If your data contains categorical variables, you have to encode them yourself (e.g.&nbsp;with pandas.get_dummies, OneHotEncoder, or OrdinalEncoder).‚Äù</p>
</blockquote>
<p>This lack of native support is a limitation, which can both complicate the analysis and distort interpretations. In contrast, R‚Äôs approach is more robust and transparent for categorical features.</p>
<p><strong>Summary Table:</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 25%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Feature Handling</th>
<th>R (<code>rpart</code>)</th>
<th>Python (<code>sklearn.tree</code>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Native categorical support?</td>
<td>Yes</td>
<td>No; must encode manually</td>
</tr>
<tr class="even">
<td>Multiway splits?</td>
<td>Yes, any grouping</td>
<td>Not directly; splits are on dummy variables</td>
</tr>
<tr class="odd">
<td>Interpretability</td>
<td>High</td>
<td>Lower, especially with many categories</td>
</tr>
<tr class="even">
<td>Official documentation?</td>
<td>‚ÄúWorks with factors‚Äù</td>
<td>‚ÄúNo support for categorical variables ‚Ä¶‚Äù (see above)</td>
</tr>
</tbody>
</table>
<p><strong>Bottom line:</strong><br>
&gt; When your feature is truly categorical (like zip code), R‚Äôs decision tree tools give more accurate and interpretable results than Python‚Äôs default scikit-learn trees. Python‚Äôs lack of native categorical support is a widely noted weakness.</p>
<ol start="3" type="1">
<li><strong>Are There Any Suggestions for Implementing Decision Trees in Python With Prioper Categorical Handling?</strong> Please poke around the Internet (AI is not as helpful with new libraries) for suggestions on how to implement decision trees in Python with better (i.e.&nbsp;not one-hot encoding) categorical handling. Please provide a link to the source and a quote from the source. There is not right answer here, but please provide a thoughtful answer, I am curious to see what you find. ### 3. Are There Solutions for Better Categorical Handling in Python Decision Trees?</li>
</ol>
<p>Python‚Äôs native scikit-learn implementation isn‚Äôt ideal for categorical features, but there <strong>are emerging tools and advances</strong> for handling this challenge. Here are practical options (as of mid-2024):</p>
</section>
<section id="a-catboost-gradient-boosting-with-native-categorical-support" class="level4">
<h4 class="anchored" data-anchor-id="a-catboost-gradient-boosting-with-native-categorical-support">a) <a href="https://catboost.ai/">CatBoost</a>: Gradient Boosting with Native Categorical Support</h4>
<p><a href="https://catboost.ai/">CatBoost</a> is a library by Yandex specifically designed for handling categorical features <strong>without one-hot encoding or label encoding tricks</strong>. Instead, it uses sophisticated algorithms (ordered target statistics) to encode categories ‚Äî making modeling faster and more interpretable for high-cardinality categorical variables.</p>
<blockquote class="blockquote">
<p><em>‚ÄúCatBoost is able to work with categorical features as is ‚Äî without the need to preprocess data in order to convert values to numbers.‚Äù</em><br>
‚Äî <a href="https://catboost.ai/en/docs/concepts/handling-categorical-features/">CatBoost documentation, Features</a></p>
</blockquote>
<p>CatBoost supports both classification and regression and can serve as a drop-in replacement for scikit-learn estimators. It <strong>automatically detects and processes categorical columns</strong>, providing more robust splits and feature importance for variables like zip code.</p>
</section>
<section id="b-lightgbm-categorical-split-support" class="level4">
<h4 class="anchored" data-anchor-id="b-lightgbm-categorical-split-support">b) <a href="https://lightgbm.readthedocs.io/en/latest/">LightGBM</a>: Categorical Split Support</h4>
<p><a href="https://lightgbm.readthedocs.io/en/latest/">LightGBM</a> (from Microsoft) also offers <strong>native support for categorical variables</strong> (when you provide them as integer-encoded values and mark them as categorical at fit time). This lets the algorithm find the optimal way to split categories ‚Äî not just simple one-hot splits.</p>
<blockquote class="blockquote">
<p><em>‚ÄúLightGBM can use categorical features directly (without one-hot encoding). ‚Ä¶ The categorical feature support is to partition them into different groups.‚Äù</em><br>
‚Äî <a href="https://lightgbm.readthedocs.io/en/latest/Advanced-Topics.html#categorical-feature-support">LightGBM documentation</a></p>
</blockquote>
</section>
<section id="c-histgradientboosting-scikit-learn-partial-support" class="level4">
<h4 class="anchored" data-anchor-id="c-histgradientboosting-scikit-learn-partial-support">c) <a href="https://scikit-learn.org/stable/modules/ensemble.html#histogram-based-gradient-boosting">HistGradientBoosting (scikit-learn)</a>: Partial Support</h4>
<p>Recent versions of scikit-learn (since 1.0) offer histogram-based gradient boosting models with a <code>categorical_features</code> argument. This isn‚Äôt available for classic <code>DecisionTreeRegressor</code>, but it‚Äôs an option when using <code>HistGradientBoostingRegressor</code>:</p>
<blockquote class="blockquote">
<p><em>‚ÄúCategorical features can be specified to be treated as categorical directly, without preprocessing, when using the histogram-based gradient boosting estimators.‚Äù</em><br>
‚Äî <a href="https://scikit-learn.org/stable/modules/ensemble.html#categorical-features-support">scikit-learn documentation</a></p>
</blockquote>
</section>
<section id="d-sklearn-tree-extension-research-tools-and-extensions" class="level4">
<h4 class="anchored" data-anchor-id="d-sklearn-tree-extension-research-tools-and-extensions">d) <a href="https://github.com/DecBayComp/sktree">sklearn-tree-extension</a>: Research Tools and Extensions</h4>
<p>There are also open-source research projects and prototypes (like <a href="https://github.com/DecBayComp/sktree">sktree</a>) that extend scikit-learn trees to better support categorical variables natively, but these are early-stage and less mature.</p>
<p>Excerpt from scikit documentation that there is no support for categorical variables, there are libraries that provide robust, natively categorical alternatives.</p>
</section>
</section>
<section id="able-to-handle-both-numerical-and-categorical-data.-however-the-scikit-learn-implementation-does-not-support-categorical-variables-for-now." class="level2">
<h2 class="anchored" data-anchor-id="able-to-handle-both-numerical-and-categorical-data.-however-the-scikit-learn-implementation-does-not-support-categorical-variables-for-now."><strong>‚ÄúAble to handle both numerical and categorical data. However, the scikit-learn implementation does not support categorical variables for now.‚Äù</strong></h2>
<p><strong>In summary:</strong><br>
While classic scikit-learn trees still lack true categorical support, <strong>libraries like CatBoost and LightGBM provide robust, natively categorical alternatives,</strong> making them preferred choices for real-world tasks involving non-ordinal features like zip codes.</p>
<p><strong>Further Reading/Sources:</strong> - CatBoost: <a href="https://catboost.ai/en/docs/concepts/handling-categorical-features/">Handling categorical features</a> - LightGBM: <a href="https://lightgbm.readthedocs.io/en/latest/Advanced-Topics.html#categorical-feature-support">Categorical feature support</a> - scikit-learn: <a href="https://scikit-learn.org/stable/modules/ensemble.html#categorical-features-support">Categorical features in histogram-based estimators</a></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>